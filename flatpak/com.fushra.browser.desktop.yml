app-id: com.fushra.browser.desktop
runtime: org.gnome.Platform
runtime-version: '3.38'
sdk: org.gnome.Sdk
command: focus-browser
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=x11
  # Wayland access
  - --socket=wayland
  # Needs to talk to the network:
  - --share=network
  # Full filesystem access
  - --filesystem=home:rw
  # Pulse audio
  - --socket=pulseaudio
  # Enable dri
  - --device=dri
  # Theme support
  - --filesystem=~/.config/dconf:ro
  - --env=DCONF_USER_CONFIG_DIR=.config/dconf
  # Session bus for fire manager
  - --socket=session-bus
  # Native notifications
  - --talk-name=org.freedesktop.Notifications
  # Enable kerbos support
  - --filesystem=/run/.heim_org.h5l.kcm-socket
modules:
  - shared-modules/gtk2/gtk2.json
  - shared-modules/python2.7/python-2.7.json
  - shared-modules/dbus-glib/dbus-glib-0.110.json
  - name: focus-browser
    buildsystem: simple
    build-commands:
      # Create folder
      - install -d /app/bin
      - install -d /app/bin/distribution
      - install -d /app/share/applications/
      # Copy files
      - cp -r bin/* /app/bin
      - cp -r distribution/* /app/bin/distribution
      # Set up freedesktop stuff
      - cp com.fushra.browser.desktop.desktop /app/share/applications/
      - cp com.fushra.browser.desktop.metainfo.xml /app/share/applications/
      - ./icons.sh
    sources:
      # Precompiled binaries
      - type: dir
        path: ./focus-browser
        dest: bin
        # Distribution configs
      - type: dir
        path: ./distribution
        dest: distribution
        # Icon setup files
      - type: file
        path: icons.sh
        # Desktop files
      - type: file
        path: com.fushra.browser.desktop.desktop
      - type: file
        path: com.fushra.browser.desktop.metainfo.xml
        # Git for up tp date icons
      - type: git
        branch: alpha
        url: https://github.com/focus-browser/browser.git
        dest: src
